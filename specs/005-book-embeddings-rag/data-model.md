# Data Model: Book Embeddings for RAG System

## BookContent Entity

**Definition**: Represents the extracted text content from book pages, including cleaned text and structural information

**Fields**:
- `url` (string): The source URL of the book page
- `title` (string): The title of the book page
- `content` (string): The cleaned text content extracted from the page
- `section` (string): The section or chapter information
- `created_at` (datetime): Timestamp when the content was extracted
- `updated_at` (datetime): Timestamp when the content was last updated

## Embedding Entity

**Definition**: Vector representation of book content chunks, generated using Cohere embedding models

**Fields**:
- `vector` (array of floats): The embedding vector generated by Cohere
- `chunk_id` (string): Unique identifier for this content chunk
- `model` (string): The embedding model used (e.g., "cohere-embed-multilingual-v3.0")
- `created_at` (datetime): Timestamp when the embedding was generated

## Metadata Entity

**Definition**: Information about the source of content including URL, page title, section, and timestamp

**Fields**:
- `source_url` (string): The original URL of the book page
- `page_title` (string): The title of the book page
- `section_info` (string): Information about the section/chapter
- `chunk_index` (integer): The index of this chunk within the page
- `total_chunks` (integer): Total number of chunks from this page
- `created_at` (datetime): Timestamp when metadata was created

## VectorRecord Entity

**Definition**: Combined entity of embedding vectors and metadata stored in the Qdrant database

**Fields**:
- `id` (string): Unique identifier for the record in Qdrant
- `payload` (object): Contains the metadata and content information
  - `url` (string): Source URL
  - `title` (string): Page title
  - `section` (string): Section information
  - `content` (string): Original content chunk
  - `chunk_index` (integer): Index of this chunk
- `vector` (array of floats): The embedding vector
- `created_at` (datetime): Timestamp when the record was created

## Relationships

- **BookContent** → **Embedding**: One-to-many (one content chunk can have multiple embeddings if chunked differently)
- **BookContent** → **Metadata**: One-to-one (each content chunk has associated metadata)
- **Embedding** + **Metadata** → **VectorRecord**: Combined to form VectorRecord for storage in Qdrant

## Validation Rules

- All URLs must be valid and accessible
- Content must not be empty before generating embeddings
- Embedding vectors must match the expected dimensions for the chosen model
- Metadata fields must be properly formatted and not null
- Chunk IDs must be unique within the system

## State Transitions

- **Content Extraction**: Raw HTML → BookContent (cleaned text with metadata)
- **Embedding Generation**: BookContent → Embedding (vector representation)
- **Storage**: Embedding + Metadata → VectorRecord (ready for Qdrant storage)