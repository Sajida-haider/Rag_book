# Data Model: Live Deployed Book RAG Backend (Cohere + Qdrant)

## Overview
This document defines the data structures and entities for the RAG backend system that ingests content from a live deployed Docusaurus book and stores embeddings in Qdrant for question answering.

## Entity: Book Content
**Description**: Represents the text content extracted from Docusaurus book pages
**Fields**:
- `url`: string - The source URL of the content
- `title`: string - The title of the page
- `content`: string - The clean, extracted text content
- `created_at`: datetime - Timestamp when the content was extracted
- `updated_at`: datetime - Timestamp when the content was last updated

**Validation Rules**:
- URL must be a valid HTTP/HTTPS URL
- Content must not be empty
- Title should be derived from HTML title tag or first heading

## Entity: Text Chunk
**Description**: Represents a segment of book content that has been processed and prepared for embedding generation
**Fields**:
- `id`: string - Unique identifier for the chunk
- `document_id`: string - Reference to the original document
- `content`: string - The chunked text content
- `chunk_index`: integer - Position of this chunk in the original document
- `metadata`: object - Additional metadata including source URL, title, etc.
- `embedding`: array - Vector embedding of the content (nullable until generated)

**Validation Rules**:
- Content must be between 50 and 1000 words
- Chunk must not be empty
- Document reference must exist

## Entity: Embedding Vector
**Description**: Represents the numerical representation of text chunks generated by Cohere's embedding model
**Fields**:
- `chunk_id`: string - Reference to the text chunk
- `vector`: array - The embedding vector (1024-dimensional for Cohere)
- `model`: string - The model used to generate the embedding
- `created_at`: datetime - Timestamp when the embedding was generated

**Validation Rules**:
- Vector must have exactly 1024 dimensions (for Cohere embed-multilingual-v3.0)
- Model name must be valid
- Chunk reference must exist

## Entity: Query Response
**Description**: Represents the system's answer to user questions, containing both the answer and source references
**Fields**:
- `query`: string - The original user query
- `answer`: string - The generated answer to the query
- `sources`: array - List of source documents/chunks that informed the answer
- `confidence`: number - Confidence score for the answer (0-1)
- `created_at`: datetime - Timestamp when the response was generated
- `relevant_chunks`: array - IDs of the chunks used to generate the answer

**Validation Rules**:
- Query must not be empty
- Answer must not be empty
- Sources must be valid document references
- Confidence must be between 0 and 1

## Qdrant Payload Schema
**Collection Name**: `rag_embedding`

**Payload Fields**:
- `content`: string - The original text chunk
- `source_url`: string - URL where the content was found
- `title`: string - Title of the source page
- `chunk_index`: integer - Position of this chunk in the original document
- `document_id`: string - Unique identifier for the document
- `created_at`: datetime - When this chunk was processed

**Vector Configuration**:
- Size: 1024 (for Cohere embeddings)
- Distance: Cosine